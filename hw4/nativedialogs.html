<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Native Browser Dialogs Example</title>
    <style>
        #output-box{
            border: solid black 2px;
            border-radius: 1rem;
        }
    </style>
    <script type="text/javascript" src="dist/purify.min.js"></script>
    <script type="module">
        //import * as cd from './customdialog.js';
        document.addEventListener('DOMContentLoaded', () => {
            cd.customdialogMain();
            console.log("DOM LOADED");
        });
    </script>
    <script>
        let clean = DOMPurify.sanitize(`<img src=x onerror=alert(1)>`, { USE_PROFILES: { html: true } });
        console.log(clean);
        //document.getElementsByTagName("output")[0].innerHTML = clean;


        function cleanUp(strings, name) {
            const str0 = strings[0];
            const str1 = strings[1];
            const str2 = strings[2];

            let cleanUserInput = DOMPurify.sanitize(`${str0}${name}${str1}${name}${str2}`, { USE_PROFILES: { html: true } });

            return cleanUserInput;
        }
        function alertFunction() {
            window.alert("TEST");
        }

        function confirmFunction() {
            let confirmBool = window.confirm("Do you Confirm?");
            if(confirmBool){
                document.getElementById("output-box").innerHTML = `<p>User Confirmed YES </p>`;
            }else{
                document.getElementById("output-box").innerHTML = `<p>User Did Not Confirm, User selected CANCEL </p>`;
            }
        }

        function promptFunction() {
            let personName = window.prompt("What is your name?");
            if(!personName.trim() == ""){
                document.getElementById("output-box").innerHTML = `<p>Welcome ${personName}!</p>
                                                                   <p>This website aims to provide cool features for users like you, ${personName}</p>`;
            }else{
                document.getElementById("output-box").innerHTML = `<p>User Confirmed NO </p>`;
            }
        }

        function saferPromptFunction() {
            let personName = window.prompt("HELLO WORLD");
            if(!personName.trim() == ""){
                document.getElementById("output-box").innerHTML = cleanUp`<p>Welcome ${personName}!</p>
                                                                   <p>This website aims to provide cool features for users like you, ${personName}</p>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            let display = document.getElementById('main-display');
            display.innerHTML += clean;
            //the event occurred
            let alertButton = document.getElementById('alert-button');
            let confirmButton = document.getElementById('confirm-button');
            let promptButton = document.getElementById('prompt-button');
            let saferPromptButton = document.getElementById('safer-prompt-button');

            alertButton.addEventListener('click', () => {
                alertFunction();
            });
            confirmButton.addEventListener('click', () => {
                confirmFunction();
            });
            promptButton.addEventListener('click', () => {
                promptFunction();
            });
            saferPromptButton.addEventListener('click', () => {
                saferPromptFunction();
            });
        })

    </script>

</head>
<body>
    <main>
        <h1> Native Dialogs</h1>
        <section id="button-box">
            <button id="alert-button">Alert</button>
            <button id="confirm-button">Confirm</button>
            <button id="prompt-button">Prompt</button>
            <button id="safer-prompt-button">Safer Prompt</button>
        </section>
        <section id="main-display">
            <output id="output-box"></output>
        </section>
    </main>

</body>
</html>